!* ========================================================================== *
!*                                                                            *
!* Copyright (C) 2020 Intel Corporation                                       *
!* This file is part of the DMR library.                                      *
!*                                                                            *
!* For information on the license, see the LICENSE file.                      *
!* Further information: https://github.com/giacrossi/dmr/                     *
!* SPDX-License-Identifier: BSD-3-Clause                                      *
!*                                                                            *
!* ========================================================================== *
!* Giacomo Rossi (Intel Corporation)                                          *
!* ========================================================================== *

         integer(I8P), intent(in)    :: i
         integer(I8P)                :: ii

#if defined _OpenMP_5_1
         print *, 'init started'
         !$omp target teams distribute parallel do device(omp_get_default_device()) has_device_addr(fptr_dev)
#else
         !$omp target teams distribute parallel do device(omp_get_default_device()) is_device_ptr(fptr_dev)
#endif
         do ii=1, i
            fptr_dev(ii) = const
         enddo
         !$omp end target teams distribute parallel do
         print *, 'init ended'
